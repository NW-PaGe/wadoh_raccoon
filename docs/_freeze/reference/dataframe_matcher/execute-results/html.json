{
  "hash": "8696ba43708151542c9a7853bbdfaefb",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: dataframe_matcher\n---\n\n\n\n`dataframe_matcher`\n\n\n\n## Classes\n\n| Name | Description |\n| --- | --- |\n| [DataFrameMatcher](#wadoh_raccoon.dataframe_matcher.DataFrameMatcher) | A utility class for matching records. |\n\n### DataFrameMatcher { #wadoh_raccoon.dataframe_matcher.DataFrameMatcher }\n\n```python\ndataframe_matcher.DataFrameMatcher(\n    self,\n    df_src: pl.DataFrame,\n    df_ref: pl.DataFrame,\n    first_name: str | tuple[str, str],\n    last_name: str | tuple[str, str],\n    dob: str | tuple[str, str],\n    spec_col_date: str | tuple[str, str],\n    key: str | list | None = None,\n    threshold: int | float = 80,\n    day_max: int | None = None,\n    business_day_max: int | None = None,\n)\n```\n\nA utility class for matching records.\n\nThis class provides functionality to match submissions to cases (epi \ndata) based on exact matching via accessions or fuzzy matching based on\npatient demographics\n\n#### Parameters {.doc-section .doc-section-parameters}\n\n<code>[**df_src**]{.parameter-name} [:]{.parameter-annotation-sep} [pl.DataFrame]{.parameter-annotation}</code>\n\n:   Source dataframe containing any Key(s) and patient demographics.\n\n<code>[**df_ref**]{.parameter-name} [:]{.parameter-annotation-sep} [pl.DataFrame]{.parameter-annotation}</code>\n\n:   Reference queried dataframe containing patient demographics.\n\n<code>[**first_name**]{.parameter-name} [:]{.parameter-annotation-sep} [str \\| tuple\\[str, str\\]]{.parameter-annotation}</code>\n\n:   The first name demographic column name in the source and reference dataframes. If the names are different, they should be provided in a tuple containing the source name first, followed by the reference name.\n\n<code>[**last_name**]{.parameter-name} [:]{.parameter-annotation-sep} [str \\| tuple\\[str, str\\]]{.parameter-annotation}</code>\n\n:   The last name demographic column name in the source and reference dataframes. If the names are different, they should be provided in a tuple containing the source name first, followed by the reference name.\n\n<code>[**dob**]{.parameter-name} [:]{.parameter-annotation-sep} [str \\| tuple\\[str, str\\]]{.parameter-annotation}</code>\n\n:   The birth date demographic column name in the source and reference dataframes. If the names are different, they should be provided in a tuple containing the source name first, followed by the reference name.\n\n<code>[**spec_col_date**]{.parameter-name} [:]{.parameter-annotation-sep} [str \\| tuple\\[str, str\\]]{.parameter-annotation}</code>\n\n:   The specimen collection date column name in the source and reference dataframes. If the names are different, they should be provided in a tuple containing the source name first, followed by the reference name.\n\n<code>[**key**]{.parameter-name} [:]{.parameter-annotation-sep} [str \\| list \\| None]{.parameter-annotation} [ = ]{.parameter-default-sep} [None]{.parameter-default}</code>\n\n:   The key (or list of keys) which group to a distinct source record. Only one match can be returned per distinct key. If no key given, each row in the source df will be treated as a distinct record to be matched.\n\n<code>[**threshold**]{.parameter-name} [:]{.parameter-annotation-sep} [int \\| float]{.parameter-annotation} [ = ]{.parameter-default-sep} [80]{.parameter-default}</code>\n\n:   The inclusive fuzzy scoring threshold used to filter fuzzy matches. Matches with a score  at or above the threshold will be returned in the fuzzy matched object. Defaults to 80.\n\n<code>[**day_max**]{.parameter-name} [:]{.parameter-annotation-sep} [int \\| None]{.parameter-annotation} [ = ]{.parameter-default-sep} [None]{.parameter-default}</code>\n\n:   The max number of days between reference and source specimen collection dates a fuzzy matched record can have and be returned as a match\n\n<code>[**business_day_max**]{.parameter-name} [:]{.parameter-annotation-sep} [int \\| None]{.parameter-annotation} [ = ]{.parameter-default-sep} [None]{.parameter-default}</code>\n\n:   The max number of business days between reference and source specimen collection dates a fuzzy matched record can have and be returned as a match. Business days are counted as weekdays (holidays are not accounted for).\n\n#### Returns {.doc-section .doc-section-returns}\n\n<code>[**fuzzy_matched_review**]{.parameter-name} [:]{.parameter-annotation-sep} [pl.DataFrame]{.parameter-annotation}</code>\n\n:   records that successfully fuzzy matched\n\n<code>[**fuzzy_without_demo**]{.parameter-name} [:]{.parameter-annotation-sep} [pl.DataFrame]{.parameter-annotation}</code>\n\n:   records missing demographics and can't be matched\n\n<code>[**fuzzy_matched_none**]{.parameter-name} [:]{.parameter-annotation-sep} [pl.DataFrame]{.parameter-annotation}</code>\n\n:   records that did not have any match\n\n<code>[**fuzzy_matched_roster**]{.parameter-name} [:]{.parameter-annotation-sep} [pl.DataFrame]{.parameter-annotation}</code>\n\n:   records that had an exact match to reference dataframe\n\n#### Examples {.doc-section .doc-section-examples}\n\n**Step 1:** Import the packages:\n\n\n::: {#c182bf1b .cell execution_count=1}\n``` {.python .cell-code}\nfrom wadoh_raccoon import dataframe_matcher as dfm\nimport polars as pl\nfrom datetime import date\n```\n:::\n\n\n**Step 2:** The fuzzy matching functions need two dataframes to match. Bring your dataframe and the reference dataframe:\n\n::: {#a4afea83 .cell execution_count=2}\n``` {.python .cell-code}\n# Create example data\nyour_df = pl.DataFrame({\n    'submission_number': [453278555, 453278555, 887730141],\n    'first_name': ['DAVIS', 'DAVIS', 'GRANT'],\n    'last_name': ['SMITHDAVIS', 'SMITHDAVIS', 'MITHCELL'],\n    'sub_collection_date': [date(2024, 11, 29), date(2024, 11, 29), date(2024, 12, 2)],\n    'birth_date': [date(1989, 7, 15), date(1989, 7, 15), date(1990, 6, 21)]\n})\n\nreference_df = pl.DataFrame({\n    'CASE_ID': [100000032, 100000041, 100020000],\n    'first_name_reference': ['DAVID', 'DAVID', 'TRASH'],\n    'last_name_reference': ['SMITDAVIS', 'SMITDAVIS', 'PANDA'],\n    'ref_collection_date': [date(2024, 11, 29), date(2024, 8, 31), date(2024, 8, 31)],\n    'birth_date': [date(1989, 7, 15), date(1989, 7, 15), date(1990, 6, 21)]\n})\n```\n:::\n\n\n**Step 3:** Initalize the fuzzy matching class and input which dataframes and columns you are matching on\n\n::: {#98ed3f43 .cell execution_count=3}\n``` {.python .cell-code}\nfuzzy_init = dfm.DataFrameMatcher(\n    df_src=your_df,\n    df_ref=reference_df,\n    first_name=('first_name', 'first_name_reference'),\n    last_name=('last_name', 'last_name_reference'),\n    dob='birth_date',\n    spec_col_date=('sub_collection_date', 'ref_collection_date'),\n    key='submission_number',\n    threshold=80  # set what kind of fuzzy threshold you want, 100 being exact match\n)\n```\n:::\n\n\n**Step 4:** Run fuzzy matching! This will output data on what matched and what didn't match.\n\n::: {#63ea2c74 .cell class-output='box' execution_count=4}\n``` {.python .cell-code}\nresult = fuzzy_init.match()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSuccess: No data leaks detected. Insert victory cigar\n0 exact matches\n1 fuzzy matched\n1 no match found\n0 records without demo\n\nTotal unique persons processed:  2 \nOriginal submissions to fuzzy (including no_match rematch attempt): 3\n```\n:::\n:::\n\n\nYou can also examine the output dataframes by pulling them out of the result class, like this:\n\n\n```python\nresult.fuzzy_unmatched\n```\n\n::: {#29991922 .cell execution_count=5}\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<div id=\"wscthlgygs\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>\n@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono&display=swap');\n#wscthlgygs table {\n          font-family: 'JetBrains Mono', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n          -webkit-font-smoothing: antialiased;\n          -moz-osx-font-smoothing: grayscale;\n        }\n\n#wscthlgygs thead, tbody, tfoot, tr, td, th { border-style: none; }\n tr { background-color: transparent; }\n#wscthlgygs p { margin: 0; padding: 0; }\n #wscthlgygs .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 3px; border-top-color: #0c0909; border-right-style: solid; border-right-width: 3px; border-right-color: #0c0909; border-bottom-style: solid; border-bottom-width: 3px; border-bottom-color: #0c0909; border-left-style: solid; border-left-width: 3px; border-left-color: #0c0909; }\n #wscthlgygs .gt_caption { padding-top: 4px; padding-bottom: 4px; }\n #wscthlgygs .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }\n #wscthlgygs .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }\n #wscthlgygs .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }\n #wscthlgygs .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }\n #wscthlgygs .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }\n #wscthlgygs .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }\n #wscthlgygs .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }\n #wscthlgygs .gt_column_spanner_outer:first-child { padding-left: 0; }\n #wscthlgygs .gt_column_spanner_outer:last-child { padding-right: 0; }\n #wscthlgygs .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; }\n #wscthlgygs .gt_spanner_row { border-bottom-style: hidden; }\n #wscthlgygs .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; }\n #wscthlgygs .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; }\n #wscthlgygs .gt_from_md> :first-child { margin-top: 0; }\n #wscthlgygs .gt_from_md> :last-child { margin-bottom: 0; }\n #wscthlgygs .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; }\n #wscthlgygs .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; }\n #wscthlgygs .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }\n #wscthlgygs .gt_row_group_first td { border-top-width: 2px; }\n #wscthlgygs .gt_row_group_first th { border-top-width: 2px; }\n #wscthlgygs .gt_striped { background-color: rgba(128,128,128,0.05); }\n #wscthlgygs .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }\n #wscthlgygs .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }\n #wscthlgygs .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }\n #wscthlgygs .gt_left { text-align: left; }\n #wscthlgygs .gt_center { text-align: center; }\n #wscthlgygs .gt_right { text-align: right; font-variant-numeric: tabular-nums; }\n #wscthlgygs .gt_font_normal { font-weight: normal; }\n #wscthlgygs .gt_font_bold { font-weight: bold; }\n #wscthlgygs .gt_font_italic { font-style: italic; }\n #wscthlgygs .gt_super { font-size: 65%; }\n #wscthlgygs .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }\n #wscthlgygs .gt_asterisk { font-size: 100%; vertical-align: 0; }\n \n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n<thead>\n\n<tr class=\"gt_col_headings\">\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black; background-color: #f9e3d6;\" scope=\"col\" id=\"index\">index</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"submission_number\">submission_number</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"first_name\">first_name</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"last_name\">last_name</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"sub_collection_date\">sub_collection_date</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"birth_date\">birth_date</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"first_name_clean\">first_name_clean</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"last_name_clean\">last_name_clean</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"submitted_collection_date\">submitted_collection_date</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"submitted_dob\">submitted_dob</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"CASE_ID\">CASE_ID</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"first_name_reference\">first_name_reference</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"last_name_reference\">last_name_reference</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"ref_collection_date\">ref_collection_date</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"birth_date_right\">birth_date_right</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"first_name_clean_right\">first_name_clean_right</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"last_name_clean_right\">last_name_clean_right</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"reference_collection_date\">reference_collection_date</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"first_name_result\">first_name_result</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"last_name_result\">last_name_result</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"reverse_first_name_result\">reverse_first_name_result</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"reverse_last_name_result\">reverse_last_name_result</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"match_ratio\">match_ratio</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"reverse_match_ratio\">reverse_match_ratio</th>\n</tr>\n</thead>\n<tbody class=\"gt_table_body\">\n  <tr>\n    <th style=\"background-color: #f9e3d6;\" class=\"gt_row gt_left gt_stub\">0</th>\n    <td class=\"gt_row gt_right\">887730141</td>\n    <td class=\"gt_row gt_left\">GRANT</td>\n    <td class=\"gt_row gt_left\">MITHCELL</td>\n    <td class=\"gt_row gt_right\">2024-12-02</td>\n    <td class=\"gt_row gt_right\">1990-06-21</td>\n    <td class=\"gt_row gt_left\">GRANT</td>\n    <td class=\"gt_row gt_left\">MITHCELL</td>\n    <td class=\"gt_row gt_right\">2024-12-02</td>\n    <td class=\"gt_row gt_right\">1990-06-21</td>\n    <td class=\"gt_row gt_right\">100020000</td>\n    <td class=\"gt_row gt_left\">TRASH</td>\n    <td class=\"gt_row gt_left\">PANDA</td>\n    <td class=\"gt_row gt_right\">2024-08-31</td>\n    <td class=\"gt_row gt_right\">1990-06-21</td>\n    <td class=\"gt_row gt_left\">TRASH</td>\n    <td class=\"gt_row gt_left\">PANDA</td>\n    <td class=\"gt_row gt_right\">2024-08-31</td>\n    <td class=\"gt_row gt_right\">40</td>\n    <td class=\"gt_row gt_right\">0</td>\n    <td class=\"gt_row gt_right\">40</td>\n    <td class=\"gt_row gt_right\">31</td>\n    <td class=\"gt_row gt_right\">20.0</td>\n    <td class=\"gt_row gt_right\">35.5</td>\n  </tr>\n</tbody>\n\n\n</table>\n\n</div>\n        \n```\n:::\n:::\n\n\n```python\nresult.fuzzy_matched\n```\n\n::: {#3e4efb7b .cell execution_count=6}\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<div id=\"bwzwmhlpoo\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>\n@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono&display=swap');\n#bwzwmhlpoo table {\n          font-family: 'JetBrains Mono', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n          -webkit-font-smoothing: antialiased;\n          -moz-osx-font-smoothing: grayscale;\n        }\n\n#bwzwmhlpoo thead, tbody, tfoot, tr, td, th { border-style: none; }\n tr { background-color: transparent; }\n#bwzwmhlpoo p { margin: 0; padding: 0; }\n #bwzwmhlpoo .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 3px; border-top-color: #0c0909; border-right-style: solid; border-right-width: 3px; border-right-color: #0c0909; border-bottom-style: solid; border-bottom-width: 3px; border-bottom-color: #0c0909; border-left-style: solid; border-left-width: 3px; border-left-color: #0c0909; }\n #bwzwmhlpoo .gt_caption { padding-top: 4px; padding-bottom: 4px; }\n #bwzwmhlpoo .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }\n #bwzwmhlpoo .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }\n #bwzwmhlpoo .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }\n #bwzwmhlpoo .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }\n #bwzwmhlpoo .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }\n #bwzwmhlpoo .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }\n #bwzwmhlpoo .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }\n #bwzwmhlpoo .gt_column_spanner_outer:first-child { padding-left: 0; }\n #bwzwmhlpoo .gt_column_spanner_outer:last-child { padding-right: 0; }\n #bwzwmhlpoo .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; }\n #bwzwmhlpoo .gt_spanner_row { border-bottom-style: hidden; }\n #bwzwmhlpoo .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; }\n #bwzwmhlpoo .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; }\n #bwzwmhlpoo .gt_from_md> :first-child { margin-top: 0; }\n #bwzwmhlpoo .gt_from_md> :last-child { margin-bottom: 0; }\n #bwzwmhlpoo .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; }\n #bwzwmhlpoo .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; }\n #bwzwmhlpoo .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }\n #bwzwmhlpoo .gt_row_group_first td { border-top-width: 2px; }\n #bwzwmhlpoo .gt_row_group_first th { border-top-width: 2px; }\n #bwzwmhlpoo .gt_striped { background-color: rgba(128,128,128,0.05); }\n #bwzwmhlpoo .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }\n #bwzwmhlpoo .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }\n #bwzwmhlpoo .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }\n #bwzwmhlpoo .gt_left { text-align: left; }\n #bwzwmhlpoo .gt_center { text-align: center; }\n #bwzwmhlpoo .gt_right { text-align: right; font-variant-numeric: tabular-nums; }\n #bwzwmhlpoo .gt_font_normal { font-weight: normal; }\n #bwzwmhlpoo .gt_font_bold { font-weight: bold; }\n #bwzwmhlpoo .gt_font_italic { font-style: italic; }\n #bwzwmhlpoo .gt_super { font-size: 65%; }\n #bwzwmhlpoo .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }\n #bwzwmhlpoo .gt_asterisk { font-size: 100%; vertical-align: 0; }\n \n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n<thead>\n\n<tr class=\"gt_col_headings\">\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black; background-color: #f9e3d6;\" scope=\"col\" id=\"index\">index</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"submission_number\">submission_number</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"first_name\">first_name</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"last_name\">last_name</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"sub_collection_date\">sub_collection_date</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"birth_date\">birth_date</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"first_name_clean\">first_name_clean</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"last_name_clean\">last_name_clean</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"submitted_collection_date\">submitted_collection_date</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"submitted_dob\">submitted_dob</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"CASE_ID\">CASE_ID</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"first_name_reference\">first_name_reference</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"last_name_reference\">last_name_reference</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"ref_collection_date\">ref_collection_date</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"birth_date_right\">birth_date_right</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"first_name_clean_right\">first_name_clean_right</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"last_name_clean_right\">last_name_clean_right</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"reference_collection_date\">reference_collection_date</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"first_name_result\">first_name_result</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"last_name_result\">last_name_result</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"reverse_first_name_result\">reverse_first_name_result</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"reverse_last_name_result\">reverse_last_name_result</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"match_ratio\">match_ratio</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"reverse_match_ratio\">reverse_match_ratio</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"day_count\">day_count</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom: 2px solid black;\" scope=\"col\" id=\"business_day_count\">business_day_count</th>\n</tr>\n</thead>\n<tbody class=\"gt_table_body\">\n  <tr>\n    <th style=\"background-color: #f9e3d6;\" class=\"gt_row gt_left gt_stub\">0</th>\n    <td class=\"gt_row gt_right\">453278555</td>\n    <td class=\"gt_row gt_left\">DAVIS</td>\n    <td class=\"gt_row gt_left\">SMITHDAVIS</td>\n    <td class=\"gt_row gt_right\">2024-11-29</td>\n    <td class=\"gt_row gt_right\">1989-07-15</td>\n    <td class=\"gt_row gt_left\">DAVIS</td>\n    <td class=\"gt_row gt_left\">SMITHDAVIS</td>\n    <td class=\"gt_row gt_right\">2024-11-29</td>\n    <td class=\"gt_row gt_right\">1989-07-15</td>\n    <td class=\"gt_row gt_right\">100000032</td>\n    <td class=\"gt_row gt_left\">DAVID</td>\n    <td class=\"gt_row gt_left\">SMITDAVIS</td>\n    <td class=\"gt_row gt_right\">2024-11-29</td>\n    <td class=\"gt_row gt_right\">1989-07-15</td>\n    <td class=\"gt_row gt_left\">DAVID</td>\n    <td class=\"gt_row gt_left\">SMITDAVIS</td>\n    <td class=\"gt_row gt_right\">2024-11-29</td>\n    <td class=\"gt_row gt_right\">80</td>\n    <td class=\"gt_row gt_right\">95</td>\n    <td class=\"gt_row gt_right\">71</td>\n    <td class=\"gt_row gt_right\">53</td>\n    <td class=\"gt_row gt_right\">87.5</td>\n    <td class=\"gt_row gt_right\">62.0</td>\n    <td class=\"gt_row gt_right\">0</td>\n    <td class=\"gt_row gt_right\">0</td>\n  </tr>\n</tbody>\n\n\n</table>\n\n</div>\n        \n```\n:::\n:::\n\n\n<br>\n<br>\n<br>\n\n#### Methods\n\n| Name | Description |\n| --- | --- |\n| [fuzzy_match](#wadoh_raccoon.dataframe_matcher.DataFrameMatcher.fuzzy_match) | Where the magic happens. Do the fuzzy matching to the dataframe |\n\n##### fuzzy_match { #wadoh_raccoon.dataframe_matcher.DataFrameMatcher.fuzzy_match }\n\n```python\ndataframe_matcher.DataFrameMatcher.fuzzy_match(dob_match)\n```\n\nWhere the magic happens. Do the fuzzy matching to the dataframe\n\n###### Parameters {.doc-section .doc-section-parameters}\n\n<code>[**dob_match**]{.parameter-name} [:]{.parameter-annotation-sep} []{.parameter-annotation}</code>\n\n:   the dataframe that has records grouped by their dob match\n\n###### Returns {.doc-section .doc-section-returns}\n\n<code>[**fuzzy_matched**]{.parameter-name} [:]{.parameter-annotation-sep} [pl.DataFrame]{.parameter-annotation}</code>\n\n:   dataframe with matches that met or exceeded the fuzzy matching score threshold\n\n<code>[**fuzzy_unmatched**]{.parameter-name} [:]{.parameter-annotation-sep} [pl.DataFrame]{.parameter-annotation}</code>\n\n:   dataframe with matches that failed to meet the fuzzy matching score threshold\n\n###### Examples {.doc-section .doc-section-examples}\n\n```python\nfrom wadoh_raccoon import dataframe_matcher as dfm\nimport polars as pl\nfrom datetime import date\n\n# Create example data\ndf = pl.DataFrame({\n    'submission_number': [453278555, 453278555, 887730141],\n    'first_name_clean': ['DAVIS', 'DAVIS', 'GRANT'],\n    'last_name_clean': ['SMITHDAVIS', 'SMITHDAVIS', 'MITHCELL'],\n    'submitted_collection_date': [date(2024, 11, 29), date(2024, 11, 29), date(2024, 12, 2)],\n    'submitted_dob': [date(1989, 7, 15), date(1989, 7, 15), date(1990, 6, 21)],\n     'CASE_ID': [100000032, 100000041, None],\n    'first_name_clean_right': ['DAVID', 'DAVID', None],\n    'last_name_clean_right': ['SMITDAVIS', 'SMITDAVIS', None],\n     'reference_collection_date': [date(2024, 11, 29), date(2024, 8, 31), None]\n})\n\n# Init dataframe matcher\n# (this is not how to use the instance but input data not used in this example)\ninstance = dfm.DataFrameMatcher(df, df)\nfuzzy_matched, fuzzy_unmatched = instance.fuzzy_match(dob_match=df)\n```\n\nFuzzy match found:\n```python\nhelpers.gt_style(df_inp=fuzzy_matched)\n```\n\nno matches found:\n```python\nhelpers.gt_style(df_inp=fuzzy_matched_none)\n```\n\n",
    "supporting": [
      "dataframe_matcher_files\\figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js\" integrity=\"sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js\" integrity=\"sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}